{% extends "accounts/base_modern.html" %}

{% block title %}{{ title }} - Transport Intelligent{% endblock %}

{% block content %}
<div class="mx-auto max-w-4xl space-y-6 p-6">
    <!-- Header -->
    <div class="rounded-2xl border border-gray-200 bg-white p-8">
        <h1 class="mb-2 text-3xl font-bold text-gray-900">
            <i class="fas fa-route mr-3 text-brand-600"></i>{{ title }}
        </h1>
        <p class="text-gray-600">Remplissez les informations du trajet</p>
    </div>

    <!-- Form -->
    <div class="rounded-2xl border border-gray-200 bg-white p-8">
        <form method="post" class="space-y-6">
            {% csrf_token %}
            
            <!-- Station de départ -->
            <div>
                <label for="depart_station" class="block text-sm font-medium text-gray-700 mb-2">
                    Station de départ <span class="text-red-500">*</span>
                </label>
                <select name="depart_station" id="depart_station" required
                        class="w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-brand-500 focus:ring-brand-500">
                    <option value="">-- Sélectionnez une station --</option>
                    {% for station in stations %}
                    <option value="{{ station.station }}">{{ station.nom }} ({{ station.adresse|default:"Pas d'adresse" }})</option>
                    {% endfor %}
                </select>
            </div>

            <!-- Station d'arrivée -->
            <div>
                <label for="arrivee_station" class="block text-sm font-medium text-gray-700 mb-2">
                    Station d'arrivée <span class="text-red-500">*</span>
                </label>
                <select name="arrivee_station" id="arrivee_station" required
                        class="w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-brand-500 focus:ring-brand-500">
                    <option value="">-- Sélectionnez une station --</option>
                    {% for station in stations %}
                    <option value="{{ station.station }}">{{ station.nom }} ({{ station.adresse|default:"Pas d'adresse" }})</option>
                    {% endfor %}
                </select>
            </div>

            <!-- Type de Trajet -->
            <div>
                <label for="type_trajet" class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-route mr-1 text-brand-600"></i>
                    Type de trajet <span class="text-red-500">*</span>
                </label>
                <select name="type_trajet" id="type_trajet" required
                        class="w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-brand-500 focus:ring-brand-500">
                    <option value="TrajetCourt">Trajet Court</option>
                    <option value="TrajetLong">Trajet Long</option>
                    <option value="TrajetTouristique">Trajet Touristique</option>
                </select>
                <p class="mt-1 text-sm text-gray-500">
                    <i class="fas fa-info-circle mr-1"></i>
                    Court: &lt;50km | Long: &gt;50km | Touristique: sites d'intérêt
                </p>
            </div>

            <!-- Véhicule (optionnel) -->
            <div>
                <label for="vehicule" class="block text-sm font-medium text-gray-700 mb-2">
                    Véhicule <span class="text-gray-400">(optionnel)</span>
                </label>
                <select name="vehicule" id="vehicule"
                        class="w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-brand-500 focus:ring-brand-500">
                    <option value="">-- Aucun véhicule --</option>
                    {% for vehicule in vehicules %}
                    <option value="{{ vehicule.vehicule }}">{{ vehicule.nom }} ({{ vehicule.matricule|default:"Pas de matricule" }})</option>
                    {% endfor %}
                </select>
            </div>

            <!-- Route (créée par le gestionnaire) -->
            <div>
                <label for="route" class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-road mr-1 text-brand-600"></i>
                    Route <span class="text-gray-400">(optionnel)</span>
                </label>
                <select name="route" id="route"
                        class="w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-brand-500 focus:ring-brand-500">
                    <option value="">-- Sélectionnez une route --</option>
                    {% for route in routes %}
                    <option value="{{ route.route }}">
                        {{ route.nom }}
                        {% if route.longueur %} - {{ route.longueur }} km{% endif %}
                        {% if route.etatRoute %} ({{ route.etatRoute }}){% endif %}
                    </option>
                    {% endfor %}
                </select>
                <p class="mt-1 text-sm text-gray-500">
                    <i class="fas fa-info-circle mr-1"></i>
                    Route pré-définie par le gestionnaire
                </p>
            </div>

            <!-- Horaire (créé par le gestionnaire) -->
            <div class="col-span-2">
                <label for="horaire" class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-clock mr-1 text-brand-600"></i>
                    Horaire <span class="text-red-500">*</span>
                </label>
                <select name="horaire" id="horaire" required
                        class="w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-brand-500 focus:ring-brand-500">
                    <option value="">-- Sélectionnez un horaire --</option>
                    {% for horaire in horaires %}
                    <option value="{{ horaire.horaire }}">
                        {% if horaire.typeVehicule %}[{{ horaire.typeVehicule }}]{% endif %}
                        {{ horaire.heureDepart|slice:":5" }} → {{ horaire.heureArrivee|slice:":5" }}
                        {% if horaire.jour %}({{ horaire.jour }}){% endif %}
                    </option>
                    {% endfor %}
                </select>
                <p class="mt-1 text-sm text-gray-500">
                    <i class="fas fa-info-circle mr-1"></i>
                    Sélectionnez un horaire créé par le gestionnaire
                </p>
            </div>

            <!-- Distance -->
            <div>
                <label for="distance" class="block text-sm font-medium text-gray-700 mb-2">
                    Distance (km) <span class="text-gray-400">(optionnel)</span>
                </label>
                <input type="number" step="0.1" name="distance" id="distance"
                       class="w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-brand-500 focus:ring-brand-500"
                       placeholder="Ex: 25.5">
            </div>

            <!-- Durée -->
            <div>
                <label for="duree" class="block text-sm font-medium text-gray-700 mb-2">
                    Durée (heures) <span class="text-gray-400">(optionnel)</span>
                </label>
                <input type="number" step="0.1" name="duree" id="duree"
                       class="w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-brand-500 focus:ring-brand-500"
                       placeholder="Ex: 1.5">
            </div>

            <!-- Buttons -->
            <div class="flex items-center justify-end space-x-4 pt-4">
                <a href="{% url 'accounts:trajets_list' %}" 
                   class="inline-flex items-center justify-center rounded-lg border border-gray-300 bg-white px-5 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50">
                    Annuler
                </a>
                <button type="submit"
                        class="inline-flex items-center justify-center rounded-lg bg-brand-600 px-5 py-2.5 text-sm font-medium text-white hover:bg-brand-700 focus:outline-none focus:ring-2 focus:ring-brand-500">
                    <i class="fas fa-save mr-2"></i> {{ submit_label }}
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
